version: 2

models:
  - name: int_deals
    description: "One row per deal with creation metadata"
    columns:
      - name: deal_id
        description: "Unique identifier for the deal"
        tests:
          - unique
          - not_null
      - name: created_at
        description: "Timestamp when the deal was created"
        tests:
          - not_null
      - name: created_month
        description: "Month when the deal was created (truncated)"
        tests:
          - not_null

  - name: int_deal_stage_transitions
    description: "Deal stage transitions with stage metadata for funnel tracking"
    columns:
      - name: deal_id
        description: "Foreign key to deals"
        tests:
          - not_null
      - name: transitioned_at
        description: "Timestamp when the deal entered this stage"
        tests:
          - not_null
      - name: stage_id
        description: "Foreign key to stages"
        tests:
          - not_null
      - name: funnel_step
        description: "Funnel step number (1-9)"

  - name: int_deal_activities
    description: "Completed sales activities (Sales Call 1, Sales Call 2) per deal"
    columns:
      - name: deal_id
        description: "Foreign key to deals"
        tests:
          - not_null
      - name: activity_type_code
        description: "Type of activity (meeting, sc_2)"
        tests:
          - not_null
          - accepted_values:
              values:
                - 'meeting'
                - 'sc_2'
      - name: funnel_activity_name
        description: "Human-readable activity name for funnel reporting"
        tests:
          - accepted_values:
              values:
                - 'Sales Call 1'
                - 'Sales Call 2'
